# IoT4I Cloud Shield Template

This shield template shows the structure of a shield that is used to build the IoT for Insurance shields. The template contains the following operators:

 ![alt text](./images/shield-template.png "Shield Template Operators")

- Annotated Source Operator:

  A Message Hub source operator that abstracts the details for connecting to IBM Message Hub. This source operator listens to the annotated events that are generated by the TransformerJob. The output of this operator is `stream<rstring userId, rstring key, rstring message>` where userId is the id of the user who owns the devices that sends the events. The key contains the IBM IoT platform topic. The message is the real event payload.


- Filter Operator:

  An **optional** operator that filters events based on any condition that the shield developer wants. It is an entry condition operator to ensure that only valid events are passed into the shield.


- Check Activation Operator:

  An **optional** IoT for Insurance operator that filters events if the user has not activated the shield.  
 
 
- Shield-specific Operators:

  Shield developers can add their own shield-specific operators. The output of his operator(s) should match the hazard schema:

  ```
  Type Hazard = rstring userId, list<rstring> rawEvents, rstring actionParams ;
   ```
   Where:

  **userId**: The id of the user who owns the device that sends the events. The userId is provided by the source operator.  
  **rawEvents**: A list of all events that caused the hazard.  
  **actionParams**: An object that contains all extra information that is required for the external action.  


- SubmitHazards Sink

  An IoT for Insurance sink operator that prepares hazards and writes them to Message Hub.




 The complete SPL code of the template is on the [ShieldTemplate.spl page](./com.ibm.iot4i.shields.template/ShieldTemplate.spl).
